var f=null;
function h(){function e(d,c){if(a[d])for(var b=0;b<a[d].length;b++)a[d][b](c)}function c(a,c){for(var b in c)a[b]=c[b];return a}var b=this,a={};b.attachEvent=function(d,c){a[d]||(a[d]=[]);a[d].push(c)};b.fireEvent=e;b.navigate=function(a){chrome.extension.sendRequest(c({action:"ci_browser_navigate"},a))};chrome.extension.onRequest.addListener(function(a){"event"==a.action&&e(a.data.name,a.data)});chrome.extension.sendRequest(c({action:"ci_browser_BeforeNavigate"},{name:b.BEFORENAVIGATE,url:document.location.href}),
function(a){b.fireEvent(b.BEFORENAVIGATE,a)})}h.prototype={NEWTAB:-1,CURRENTTAB:-2,NEWWINDOW:-3,DOCUMENTCOMPLETE:"DocumentComplete",BEFORENAVIGATE:"BeforeNavigate",DNSERROR:"DNSError",TABCHANGED:"TabChanged"};window.framework={browser:new h,extension:new function(){var e=this,c={},b={name:f,version:f,description:f,url:f,author:f,updateUrl:f,statUrl:f};chrome.extension.sendRequest({action:"ci_extension_getSettings"},function(a){for(var d in a)b[d]=a[d];e.__defineGetter__("name",function(){return b.name});e.__defineGetter__("version",function(){return b.version});e.__defineGetter__("description",function(){return b.description});e.__defineGetter__("url",function(){return b.url});e.__defineGetter__("author",function(){return b.author});
e.__defineGetter__("updateUrl",function(){return b.updateUrl});e.__defineGetter__("statUrl",function(){return b.statUrl})});this.fireEvent=function(a,d,b){b?chrome.extension.sendRequest({action:"event",name:a,data:d},b):chrome.extension.sendRequest({action:"event",name:a,data:d});if(c[a])for(var g=0;g<c[a].length;g++)c[a][g].call(e,d,b)};this.attachEvent=function(a,d){c[a]||(c[a]=[]);c[a].push(d)};this.detachEvent=function(a,d){if(c[a])for(var b=0;b<c[a].length;b++)d&&d===c[a][b]&&(delete c[a][b],
c[a][b]=f,c[a].splice(b,1))};this.log=function(){console.log.apply(console,arguments)};this.setItem=function(a,b){chrome.extension.sendRequest({action:"ci_extension_setVar",id:a,value:b})};this.getItem=function(a,b){chrome.extension.sendRequest({action:"ci_extension_getVar",id:a},b)};this.getId=function(a){chrome.extension.sendRequest({action:"ci_extension_getId"},a)};this.stat=function(a){chrome.extension.sendRequest({action:"ci_extension_stat",data:a})};chrome.extension.onRequest.addListener(function(a,
b,i){if("event"==a.action&&(b=a.name,a={data:a.data.data},c[b]))for(var g=0;g<c[b].length;g++)c[b][g]&&c[b][g].call(e,a,i)})}};
